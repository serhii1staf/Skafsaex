<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Telegram Web App</title>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            font-family: 'Roboto', Arial, sans-serif;
            background: url('https://i.postimg.cc/qMd2txdk/IMG-4570.png') no-repeat center center fixed;
            background-size: cover;
            color: white;
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        #app {
            display: flex;
            flex-direction: column;
            height: 100%;
        }

        #content {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
        }

        #navbar {
            display: flex;
            justify-content: space-around;
            background: none;
            padding: 10px 0;
            position: fixed;
            bottom: 0;
            width: 100%;
        }

        #navbar button {
            background: none;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
            opacity: 0.7;
        }

        #navbar button:hover {
            opacity: 1;
        }

        #chat {
            display: flex;
            flex-direction: column;
            height: 100%;
        }

        #messages {
            flex: 1;
            overflow-y: auto;
            padding: 10px;
        }

        #messageInput {
            width: calc(100% - 100px);
            padding: 10px;
            margin-right: 10px;
        }

        .user-message {
            text-align: right;
            margin: 10px 0;
        }

        .bot-message {
            text-align: left;
            margin: 10px 0;
        }

        .hidden {
            display: none;
        }

        .article {
            background: rgba(51, 51, 51, 0.8);
            padding: 10px;
            margin: 10px 0;
        }

        .article img {
            width: 100%;
        }

        .login-form {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .login-form input {
            margin: 5px 0;
            padding: 10px;
            width: 200px;
        }

        .login-form button {
            padding: 10px;
            width: 100px;
            cursor: pointer;
        }

        .admin-panel {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .admin-panel input, .admin-panel textarea {
            margin: 5px 0;
            padding: 10px;
            width: 200px;
        }

        .admin-panel button {
            padding: 10px;
            width: 100px;
            cursor: pointer;
        }

        .preview {
            background: rgba(51, 51, 51, 0.8);
            padding: 10px;
            margin: 10px 0;
        }

        .icon {
            display: inline-block;
            width: 100px;
            height: 100px;
            background-size: cover;
            margin: 10px;
            cursor: pointer;
        }

        .dark-mode {
            background-color: #1A1F36;
            color: white;
        }

        .light-mode {
            background-color: #FFFFFF;
            color: black;
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
    <div id="app">
        <div id="content">
            <!-- Main content will be loaded here -->
        </div>
        <div id="navbar">
            <button onclick="navigate('info')"><i class="fa-regular fa-house"></i></button>
            <button onclick="navigate('ai')"><i class="fa-solid fa-robot"></i></button>
            <button onclick="navigate('news')"><i class="fa-solid fa-newspaper"></i></button>
            <button onclick="navigate('settings')"><i class="fa-solid fa-gear"></i></button>
        </div>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            navigate('info');
        });

        function navigate(screen) {
            const content = document.getElementById('content');
            const navbar = document.getElementById('navbar');
            content.innerHTML = '';

            switch (screen) {
                case 'info':
                    content.innerHTML = '<h1>Главная страница</h1>';
                    navbar.classList.remove('hidden');
                    break;
                case 'ai':
                    content.innerHTML = `
                        <div id="chat">
                            <div id="messages"></div>
                            <div style="display: flex; padding: 10px; position: fixed; bottom: 0; width: 100%; background: rgba(51, 51, 51, 0.8);">
                                <input type="text" id="messageInput" placeholder="Введите сообщение...">
                                <button onclick="sendMessage()">Отправить</button>
                            </div>
                        </div>
                    `;
                    navbar.classList.add('hidden');
                    const homeButton = document.createElement('button');
                    homeButton.innerHTML = '<i class="fa-regular fa-house"></i>';
                    homeButton.style.position = 'fixed';
                    homeButton.style.top = '10px';
                    homeButton.style.right = '10px';
                    homeButton.style.background = 'none';
                    homeButton.style.border = 'none';
                    homeButton.style.color = 'white';
                    homeButton.style.fontSize = '24px';
                    homeButton.style.cursor = 'pointer';
                    homeButton.onclick = () => {
                        navigate('info');
                        homeButton.remove();
                    };
                    document.body.appendChild(homeButton);
                    break;
                case 'news':
                    content.innerHTML = `
                        <div id="articles">
                            <button onclick="showArticleForm()">Добавить статью</button>
                            <div id="articleList"></div>
                        </div>
                    `;
                    loadArticles();
                    break;
                case 'settings':
                    content.innerHTML = `
                        <h2>Настройки</h2>
                        <button onclick="showLoginForm()">Админ</button>
                        <button onclick="changeBackground()">Изменить цвет фона</button>
                        <div>
                            <label>
                                <input type="radio" name="background" value="dark" onclick="changeBackgroundColor('dark')"> Тёмный
                            </label>
                            <label>
                                <input type="radio" name="background" value="black" onclick="changeBackgroundColor('black')"> Чёрный
                            </label>
                            <label>
                                <input type="radio" name="background" value="gray" onclick="changeBackgroundColor('gray')"> Серый
                            </label>
                        </div>
                        <button onclick="toggleTheme()">Переключить тему</button>
                    `;
                    break;
            }
        }

        function sendMessage() {
            const input = document.getElementById('messageInput');
            const message = input.value;
            if (message.trim() === '') return;

            const messages = document.getElementById('messages');
            const userMessage = document.createElement('div');
            userMessage.className = 'user-message';
            userMessage.textContent = message;
            messages.appendChild(userMessage);

            input.value = '';

            // Simulate AI response
            setTimeout(() => {
                const botMessage = document.createElement('div');
                botMessage.className = 'bot-message';
                botMessage.textContent = 'Ответ от бота: ' + message;
                messages.appendChild(botMessage);
            }, 1000);
        }

        function showArticleForm() {
            const articleForm = `
                <div id="articleForm">
                    <input type="text" id="articleTitle" placeholder="Заголовок">
                    <textarea id="articleText" placeholder="Текст"></textarea>
                    <input type="file" id="articleImage" accept="image/*">
                    <button onclick="previewArticle()">Предварительный просмотр</button>
                    <button onclick="addArticle()">Добавить</button>
                </div>
            `;
            document.getElementById('content').innerHTML += articleForm;
        }

        function previewArticle() {
            const title = document.getElementById('articleTitle').value;
            const text = document.getElementById('articleText').value;
            const image = document.getElementById('articleImage').files[0];

            if (title.trim() === '' || text.trim() === '') return;

            const reader = new FileReader();
            reader.onload = function(e) {
                const preview = document.createElement('div');
                preview.className = 'preview';
                preview.innerHTML = `<h3>${title}</h3><img src="${e.target.result}" alt="Article Image"><p>${text}</p>`;
                document.getElementById('content').appendChild(preview);
            };
            reader.readAsDataURL(image);
        }

        function addArticle() {
            const title = document.getElementById('articleTitle').value;
            const text = document.getElementById('articleText').value;
            const image = document.getElementById('articleImage').files[0];

            if (title.trim() === '' || text.trim() === '') return;

            const reader = new FileReader();
            reader.onload = function(e) {
                const articleList = document.getElementById('articleList');
                const article = document.createElement('div');
                article.className = 'article';
                article.innerHTML = `<h3>${title}</h3><img src="${e.target.result}" alt="Article Image"><p>${text}</p>`;
                articleList.appendChild(article);

                document.getElementById('articleForm').remove();
                saveArticle({ title, text, image: e.target.result });
            };
            reader.readAsDataURL(image);
        }

        function loadArticles() {
            const articles = JSON.parse(localStorage.getItem('articles') || '[]');
            const articleList = document.getElementById('articleList');
            articles.forEach(article => {
                const articleElement = document.createElement('div');
                articleElement.className = 'article';
                articleElement.innerHTML = `<h3>${article.title}</h3><img src="${article.image}" alt="Article Image"><p>${article.text.substring(0, 100)}...</p>`;
                articleElement.onclick = () => showFullArticle(article);
                articleList.appendChild(articleElement);
            });
        }

        function saveArticle(article) {
            const articles = JSON.parse(localStorage.getItem('articles') || '[]');
            articles.push(article);
            localStorage.setItem('articles', JSON.stringify(articles));
        }

        function showFullArticle(article) {
            const content = document.getElementById('content');
            content.innerHTML = `
                <div class="article">
                    <h3>${article.title}</h3>
                    <img src="${article.image}" alt="Article Image">
                    <p>${article.text}</p>
                    <button onclick="editArticle('${article.title}')">Редактировать</button>
                    <button onclick="deleteArticle('${article.title}')">Удалить</button>
                </div>
            `;
        }

        function editArticle(title) {
            const articles = JSON.parse(localStorage.getItem('articles') || '[]');
            const article = articles.find(a => a.title === title);
            if (!article) return;

            const content = document.getElementById('content');
            content.innerHTML = `
                <div id="articleForm">
                    <input type="text" id="articleTitle" value="${article.title}" placeholder="Заголовок">
                    <textarea id="articleText" placeholder="Текст">${article.text}</textarea>
                    <input type="file" id="articleImage" accept="image/*">
                    <button onclick="previewArticle()">Предварительный просмотр</button>
                    <button onclick="updateArticle('${title}')">Обновить</button>
                </div>
            `;
        }

        function updateArticle(oldTitle) {
            const title = document.getElementById('articleTitle').value;
            const text = document.getElementById('articleText').value;
            const image = document.getElementById('articleImage').files[0];

            if (title.trim() === '' || text.trim() === '') return;

            const articles = JSON.parse(localStorage.getItem('articles') || '[]');
            const articleIndex = articles.findIndex(a => a.title === oldTitle);
            if (articleIndex === -1) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                articles[articleIndex] = { title, text, image: e.target.result };
                localStorage.setItem('articles', JSON.stringify(articles));
                loadArticles();
                navigate('news');
            };
            reader.readAsDataURL(image);
        }

        function deleteArticle(title) {
            let articles = JSON.parse(localStorage.getItem('articles') || '[]');
            articles = articles.filter(a => a.title !== title);
            localStorage.setItem('articles', JSON.stringify(articles));
            loadArticles();
            navigate('news');
        }

        function changeBackgroundColor(color) {
            switch (color) {
                case 'dark':
                    document.body.style.backgroundColor = '#1A1F36';
                    break;
                case 'black':
                    document.body.style.backgroundColor = '#000';
                    break;
                case 'gray':
                    document.body.style.backgroundColor = '#777';
                    break;
            }
        }

        function showLoginForm() {
            const content = document.getElementById('content');
            content.innerHTML = `
                <div class="login-form">
                    <input type="text" id="login" placeholder="Логин">
                    <input type="password" id="password" placeholder="Пароль">
                    <button onclick="login()">Войти</button>
                </div>
            `;
        }

        function login() {
            const login = document.getElementById('login').value;
            const password = document.getElementById('password').value;

            if (login === 'admin' && password === 'Pa$$w0rd123') {
                alert('Вход успешно выполнен');
                showAdminPanel();
            } else {
                alert('Неверный логин или пароль');
            }
        }

        function showAdminPanel() {
            const content = document.getElementById('content');
            content.innerHTML = `
                <div class="admin-panel">
                    <button onclick="showArticleForm()">Добавить статью</button>
                    <button onclick="toggleTheme()">Переключить тему</button>
                </div>
            `;
        }

        function toggleTheme() {
            const body = document.body;
            if (body.classList.contains('dark-mode')) {
                body.classList.remove('dark-mode');
                body.classList.add('light-mode');
            } else {
                body.classList.remove('light-mode');
                body.classList.add('dark-mode');
            }
        }

        document.addEventListener('swiped-left', () => {
            const currentScreen = document.getElementById('content').innerHTML;
            if (currentScreen.includes('Главная страница')) {
                navigate('ai');
            } else if (currentScreen.includes('Искусственный интеллект')) {
                navigate('news');
            } else if (currentScreen.includes('Новости/Статьи')) {
                navigate('settings');
            }
        });

        document.addEventListener('swiped-right', () => {
            const currentScreen = document.getElementById('content').innerHTML;
            if (currentScreen.includes('Настройки')) {
                navigate('news');
            } else if (currentScreen.includes('Новости/Статьи')) {
                navigate('ai');
            } else if (currentScreen.includes('Искусственный интеллект')) {
                navigate('info');
            }
        });

        // Swipe event listeners
        document.addEventListener('touchstart', handleTouchStart, false);
        document.addEventListener('touchmove', handleTouchMove, false);

        let xDown = null;
        let yDown = null;

        function handleTouchStart(evt) {
            const firstTouch = evt.touches[0];
            xDown = firstTouch.clientX;
            yDown = firstTouch.clientY;
        }

        function handleTouchMove(evt) {
            if (!xDown || !yDown) {
                return;
            }

            const xUp = evt.touches[0].clientX;
            const yUp = evt.touches[0].clientY;

            const xDiff = xDown - xUp;
            const yDiff = yDown - yUp;

            if (Math.abs(xDiff) > Math.abs(yDiff)) {
                if (xDiff > 0) {
                    document.dispatchEvent(new Event('swiped-left'));
                } else {
                    document.dispatchEvent(new Event('swiped-right'));
                }
            }

            xDown = null;
            yDown = null;
        }
    </script>
</body>
</html>
