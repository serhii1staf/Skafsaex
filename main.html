<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Assistant</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
        }

        body {
            background: #000000;
            color: #ffffff;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Снежинки */
        .snowflake {
            position: fixed;
            width: 4px;
            height: 4px;
            background: #ffffff;
            border-radius: 50%;
            pointer-events: none;
            filter: blur(1px);
            animation: fall linear infinite;
            z-index: 1;
            box-shadow: 0 0 5px #ffffff;
            opacity: 0.6;
        }

        @keyframes fall {
            to {
                transform: translateY(100vh) rotate(360deg);
            }
        }

        /* Анимированный робот */
        .robot {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            width: 60px;
            height: 60px;
            background: #2ea6ff;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            animation: float 3s ease-in-out infinite;
            box-shadow: 0 0 30px #2ea6ff;
        }

        .robot svg {
            width: 40px;
            height: 40px;
            fill: white;
            filter: drop-shadow(0 0 5px rgba(255, 255, 255, 0.8));
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateX(-50%) translateY(0); }
            50% { transform: translateX(-50%) translateY(-10px); }
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 0.9; }
            50% { transform: scale(1.1); opacity: 1; }
        }

        /* Чат */
        .chat-container {
            padding: 80px 20px 100px;
            height: 100vh;
            overflow-y: auto;
            position: relative;
            z-index: 2;
        }

        .messages-wrapper {
            max-width: 800px;
            margin: 0 auto;
            width: 100%;
        }

        .message {
            margin: 10px 0;
            padding: 12px 16px;
            border-radius: 16px;
            max-width: 80%;
            animation: fadeIn 0.3s ease-in-out;
            position: relative;
            line-height: 1.5;
            word-wrap: break-word;
            background: rgba(45, 45, 45, 0.5);
            backdrop-filter: blur(10px);
        }

        .user-message {
            background: rgba(46, 166, 255, 0.8);
            margin-left: auto;
            border-bottom-right-radius: 4px;
        }

        .bot-message {
            background: rgba(45, 45, 45, 0.5);
            margin-right: auto;
            border-bottom-left-radius: 4px;
            padding-left: 45px;
        }

        .message-icon {
            position: absolute;
            left: 8px;
            top: 50%;
            transform: translateY(-50%);
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .message-icon svg {
            width: 24px;
            height: 24px;
            fill: #2ea6ff;
            filter: drop-shadow(0 0 3px #2ea6ff);
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Поле ввода */
        .input-container {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            padding: 15px;
            background: rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            display: flex;
            gap: 12px;
            z-index: 1000;
        }

        .input-field {
            flex: 1;
            padding: 12px 16px;
            border: none;
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 16px;
            transition: all 0.3s ease;
            max-width: 800px;
            margin: 0 auto;
        }

        .input-field:focus {
            outline: none;
            background: rgba(255, 255, 255, 0.15);
        }

        .send-button {
            width: 44px;
            height: 44px;
            border: none;
            border-radius: 50%;
            background: #2ea6ff;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0;
            box-shadow: 0 0 15px #2ea6ff;
        }

        .send-button:hover {
            background: #52b5ff;
            transform: scale(1.05);
        }

        .send-button svg {
            width: 24px;
            height: 24px;
            fill: white;
            transform: rotate(45deg);
        }

        /* Скроллбар */
        .chat-container::-webkit-scrollbar {
            width: 6px;
        }

        .chat-container::-webkit-scrollbar-track {
            background: transparent;
        }

        .chat-container::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 3px;
        }

        @media (max-width: 600px) {
            .chat-container {
                padding: 80px 10px 90px;
            }

            .message {
                max-width: 85%;
                font-size: 15px;
            }

            .input-container {
                padding: 10px;
            }
        }
    </style>
</head>
<body>
    <!-- Анимированный робот -->
    <div class="robot">
        <svg viewBox="0 0 24 24">
            <path d="M12,2A2,2 0 0,1 14,4C14,4.74 13.6,5.39 13,5.73V7H14A7,7 0 0,1 21,14H22A1,1 0 0,1 23,15V18A1,1 0 0,1 22,19H21V20A2,2 0 0,1 19,22H5A2,2 0 0,1 3,20V19H2A1,1 0 0,1 1,18V15A1,1 0 0,1 2,14H3A7,7 0 0,1 10,7H11V5.73C10.4,5.39 10,4.74 10,4A2,2 0 0,1 12,2M7.5,13A2.5,2.5 0 0,0 5,15.5A2.5,2.5 0 0,0 7.5,18A2.5,2.5 0 0,0 10,15.5A2.5,2.5 0 0,0 7.5,13M16.5,13A2.5,2.5 0 0,0 14,15.5A2.5,2.5 0 0,0 16.5,18A2.5,2.5 0 0,0 19,15.5A2.5,2.5 0 0,0 16.5,13Z" />
        </svg>
    </div>

    <!-- Чат -->
    <div class="chat-container" id="chatContainer">
        <div class="messages-wrapper" id="messagesWrapper"></div>
    </div>

    <!-- Поле ввода -->
    <div class="input-container">
        <input type="text" class="input-field" id="questionInput" placeholder="Введите ваш вопрос...">
        <button class="send-button" id="sendButton">
            <svg viewBox="0 0 24 24">
                <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/>
            </svg>
        </button>
    </div>

    <script>
        // База данных вопросов и ответов
        const database = {
    // Базовые навыки и знания 
    "как научиться программировать": "Начните с изучения основ (переменные, циклы, условия) на простом языке как Python, практикуйтесь через небольшие проекты, используйте онлайн-ресурсы для обучения.",
    "как выучить английский язык": "Практикуйте регулярно: смотрите фильмы на английском, читайте книги, используйте приложения для изучения языка, общайтесь с носителями языка.",
    "как развить критическое мышление": "Задавайте вопросы, анализируйте информацию с разных точек зрения, практикуйте решение логических задач и головоломок.",
    
    // Карьера и профессиональное развитие
    "как написать резюме": "Включите ваш опыт работы, образование, навыки. Используйте конкретные примеры достижений. Адаптируйте под конкретную вакансию.",
    "как пройти собеседование": "Подготовьтесь: изучите компанию, подготовьте ответы на типичные вопросы, оденьтесь соответственно, придите вовремя.",
    "как выбрать профессию": "Оцените свои интересы, способности и навыки. Изучите рынок труда и перспективы разных профессий. Попробуйте стажировки.",
    
    // Технологии и программирование
    "что такое нейронные сети": "Нейронные сети - это компьютерные системы, имитирующие работу человеческого мозга, способные обучаться на основе примеров и распознавать паттерны.",
    "что такое криптовалюта": "Криптовалюта - это цифровая или виртуальная валюта, использующая криптографию для обеспечения безопасности транзакций.",
    "что такое метавселенная": "Метавселенная - это виртуальное пространство, где люди могут взаимодействовать друг с другом и цифровыми объектами через аватары.",
    
    // Здоровье и медицина
    "как укрепить иммунитет": "Правильно питайтесь, регулярно занимайтесь спортом, высыпайтесь, минимизируйте стресс, принимайте витамины по рекомендации врача.",
    "как улучшить зрение": "Делайте гимнастику для глаз, соблюдайте режим работы за компьютером, обеспечьте хорошее освещение, регулярно проверяйте зрение.",
    "как бороться со стрессом": "Практикуйте медитацию, дыхательные упражнения, регулярно занимайтесь спортом, высыпайтесь, найдите хобби.",
            "привет": "Здравствуйте! Как я могу вам помочь?",
            "здравствуйте": "Добрый день! Чем могу помочь?",
            "доброе утро": "Доброе утро! Как ваши дела?",
            "добрый день": "Добрый день! Рад вас видеть?",
            "какая сегодня погода": "Я не могу сказать точно, так как не имею доступа к актуальным данным о погоде. Лучше проверить прогноз погоды в вашем регионе.",
            "когда будет дождь": "Я не могу предсказать погоду. Рекомендую посмотреть прогноз погоды для вашего региона.",
            "почему идет снег": "Снег образуется, когда водяной пар в атмосфере замерзает и превращается в кристаллы льда при температуре ниже нуля градусов.",
            "который час": "Я не могу показать текущее время. Посмотрите, пожалуйста, на часы.",
            "какой сегодня день": "Я не могу сказать текущую дату. Проверьте, пожалуйста, календарь.",
            "когда новый год": "Новый год наступает 1 января.",
            "что такое физика": "Физика - это наука о материи, энергии и их взаимодействиях. Она изучает фундаментальные законы природы.",
            "что такое химия": "Химия - наука о веществах, их составе, строении, свойствах и превращениях.",
            "что такое биология": "Биология - наука о живых организмах, их строении, функциях, развитии и взаимодействии с окружающей средой.",
            "что такое математика": "Математика - наука о структурах, порядке и отношениях, которая исторически сложилась на основе операций подсчёта, измерения и описания форм.",
            "что такое история": "История - наука, изучающая прошлое человечества по материальным свидетельствам жизни людей.",
            "что такое география": "География - наука о земной поверхности, её природе, населении, хозяйственной деятельности и территориальной организации.",

            // Технологии и программирование
            "что такое интернет": "Интернет - глобальная компьютерная сеть, соединяющая миллионы компьютеров по всему миру.",
            "что такое компьютер": "Компьютер - электронное устройство для обработки информации по заданной программе.",
            "что такое программирование": "Программирование - процесс создания компьютерных программ с помощью языков программирования.",
            "что такое искусственный интеллект": "Искусственный интеллект - это технология, позволяющая компьютерам имитировать человеческий интеллект.",
            "что такое робот": "Робот - автоматическое устройство, предназначенное для выполнения различных задач.",

            // Искусство и культура
            "что такое музыка": "Музыка - искусство организации звуков во времени, один из видов художественного творчества.",
            "что такое живопись": "Живопись - вид изобразительного искусства, связанный с передачей зрительных образов с помощью красок.",
            "что такое театр": "Театр - вид искусства, в котором актёры представляют истории перед зрителями с помощью речи, музыки и движения.",
            "что такое кино": "Кино - вид искусства, создающий движущиеся изображения с помощью кинематографа.",

            // Спорт и здоровье
            "что такое спорт": "Спорт - организованная деятельность людей, направленная на физическое развитие и соревнование.",
            "как похудеть": "Для похудения нужно соблюдать здоровое питание и регулярно заниматься физическими упражнениями.",
            "как набрать вес": "Для набора веса важно увеличить потребление калорий и заниматься силовыми тренировками.",
            "как правильно питаться": "Правильное питание включает разнообразные продукты, много овощей и фруктов, умеренное потребление жиров и сахара.",

            // Психология и отношения
            "как найти друзей": "Чтобы найти друзей, будьте открыты к общению, посещайте мероприятия по интересам, проявляйте искренний интерес к людям.",
            "как стать увереннее": "Для уверенности важно ставить цели, достигать их, работать над самооценкой и не бояться ошибок.",
            "как справиться со стрессом": "Для борьбы со стрессом помогают физические упражнения, медитация, правильный сон и поддержка близких.",

            // Бизнес и карьера
            "как найти работу": "Для поиска работы обновите резюме, используйте сайты вакансий, networking и профессиональные социальные сети.",
            "как открыть бизнес": "Чтобы открыть бизнес, нужно разработать бизнес-план, найти финансирование и зарегистрировать предприятие.",
            "как стать успешным": "Успех требует постановки целей, упорного труда, постоянного обучения и умения общаться с людьми.",

            // Путешествия
            "как путешествовать": "Для путешествий планируйте маршрут, бронируйте билеты заранее, изучайте местную культуру и берите необходимые документы.",
            "что взять в поездку": "В поездку возьмите документы, деньги, одежду по погоде, предметы гигиены и базовые лекарства.",
            "как сэкономить в путешествии": "Экономить в путешествии помогают раннее бронирование, поиск скидок, проживание в хостелах и готовка самостоятельно.",

            // Хобби и увлечения
            "как научиться рисовать": "Чтобы научиться рисовать, начните с основ, практикуйтесь регулярно, изучайте работы других художников.",
            "как научиться петь": "Для обучения пению важны регулярные упражнения, правильное дыхание и работа с преподавателем.",
            "как научиться танцевать": "Начните с базовых движений, посещайте уроки танцев, практикуйтесь регулярно.",

            // Дом и быт
            "как убраться в квартире": "Уборку делайте поэтапно: сначала уберите лишнее, затем протрите пыль, пропылесосьте и помойте полы.",
            "как готовить": "Начните с простых рецептов, следуйте инструкциям, практикуйтесь и не бойтесь экспериментировать.",
            "как ухаживать за растениями": "Растениям нужны правильный полив, освещение, температура и периодическая подкормка.",

            // Финансы
            "как экономить деньги": "Для экономии ведите учет расходов, планируйте покупки, ищите скидки и откладывайте часть дохода.",
            "как инвестировать": "Начните с изучения основ инвестирования, оцените риски и проконсультируйтесь со специалистами.",
            "как заработать": "Для заработка развивайте профессиональные навыки, ищите дополнительные источники дохода, создавайте ценность для других.",

            // Технические вопросы
            "почему не работает интернет": "Проверьте подключение к сети, перезагрузите роутер, свяжитесь с провайдером.",
            "как ускорить компьютер": "Удалите ненужные файлы, проверьте на вирусы, обновите программы и очистите кэш.",
            "как защитить данные": "Используйте надежные пароли, антивирус, регулярно делайте резервные копии.",

            // Природа и экология
            "почему небо голубое": "Небо кажется голубым из-за рассеивания солнечного света молекулами воздуха.",
            "почему идет дождь": "Дождь образуется, когда водяной пар в облаках конденсируется и капли становятся достаточно тяжелыми.",
            "как защитить природу": "Сортируйте мусор, экономьте ресурсы, используйте экологичный транспорт, сажайте растения.",

            // Философские вопросы
            "в чем смысл жизни": "Смысл жизни каждый определяет для себя сам. Это может быть саморазвитие, помощь другим, творчество или достижение целей.",
            "что такое счастье": "Счастье - это субъективное чувство удовлетворения и радости, у каждого оно свое.",
            "что такое любовь": "Любовь - глубокое чувство привязанности и заботы к другому человеку или чему-либо.",

            // Развлечения
            "какой фильм посмотреть": "Выбор фильма зависит от ваших предпочтений. Могу порекомендовать посмотреть рейтинги и обзоры.",
            "какую книгу почитать": "Выбор книги зависит от ваших интересов. Можно начать с классики или бестселлеров в интересующем жанре.",
            "во что поиграть": "Есть много интересных игр разных жанров. Выбор зависит от ваших предпочтений и доступного времени.",

            // Праздники и традиции
            "когда день рождения": "День рождения - это личный праздник, который отмечается в день появления человека на свет.",
            "как отметить новый год": "Новый год можно отметить с семьей и друзьями, приготовить праздничный ужин, обменяться подарками.",
            "что подарить на праздник": "Выбор подарка зависит от интересов и предпочтений человека, которому вы хотите его преподнести.",

            "как сделать домашнее задание": "Для выполнения домашнего задания важно организовать свое время и использовать доступные ресурсы.",
            "что такое здоровье": "Здоровье - это состояние полного физического, душевного и социального благополучия.",
            "как улучшить память": "Для улучшения памяти полезно заниматься умственными упражнениями, правильно питаться и достаточно спать.",
            "как правильно спать": "Для здорового сна важно соблюдать режим, создавать комфортную обстановку и избегать перед сном экранов.",
            "как правильно питаться": "Правильное питание включает разнообразные продукты, много овощей и фруктов, умеренное потребление жиров и сахара.",
            "как правильно заниматься спортом": "Для эффективных тренировок важно выбирать подходящий вид спорта, следить за техникой и не перегружать организм.",

            // Новая база слов
            "Как работает алгоритм шифрования AES?": "AES (Advanced Encryption Standard) - это симметричный алгоритм шифрования, который использует ключи длиной 128, 192 или 256 бит для шифрования и дешифрования данных.",
            "Что такое микросервисная архитектура?": "Микросервисная архитектура - это подход к разработке программного обеспечения, при котором приложение разбивается на небольшие, независимые сервисы, которые взаимодействуют друг с другом через API.",
            "Как настроить автоматическое тестирование с использованием Jenkins?": "Создайте проект в Jenkins, добавьте шаги сборки для выполнения тестов и настройте триггеры для автоматического запуска тестов при изменении кода.",
            "Что такое технология WebAssembly?": "WebAssembly - это бинарный формат для выполнения кода в веб-браузере, который позволяет запускать высокопроизводительные приложения на веб-страницах.",
            "Как работает система контроля версий Git?": "Git - это распределённая система контроля версий, которая позволяет отслеживать изменения в коде, управлять ветками и слияниями, а также сотрудничать с другими разработчиками.",
            "Что такое SQL-инъекция?": "SQL-инъекция - это уязвимость безопасности, при которой злоумышленник может выполнить произвольные SQL-запросы на сервере базы данных, вставив вредоносный код в пользовательский ввод.",
            "Как создать REST API с использованием Express.js?": "Установите Express.js, создайте маршруты для обработки HTTP-запросов и используйте методы get, post, put и delete для реализации CRUD-операций.",
            "Что такое контейнеризация с помощью Docker?": "Docker - это платформа для контейнеризации, которая позволяет упаковывать приложения и их зависимости в изолированные контейнеры для удобного развертывания и масштабирования.",
            "Как работает алгоритм машинного обучения K-ближайших соседей?": "K-ближайших соседей (KNN) - это алгоритм машинного обучения, который классифицирует объекты на основе их близости к объектам в обучающем наборе данных.",
            "Что такое DevOps?": "DevOps - это набор практик, который объединяет разработку и операционные команды для улучшения сотрудничества и ускорения выпуска программного обеспечения.",
            "Как создать одностраничное приложение (SPA) с использованием React?": "Используйте create-react-app для создания нового проекта, создайте компоненты для вашего приложения и настройте маршрутизацию с помощью react-router-dom.",
            "Что такое шаблон проектирования Observer?": "Observer - это шаблон проектирования, который определяет зависимость один ко многим между объектами, так что при изменении состояния одного объекта все зависимые объекты оповещаются и обновляются автоматически.",
            "Как настроить кэширование с помощью Redis?": "Установите и настройте сервер Redis, затем используйте библиотеки для вашего языка программирования для взаимодействия с Redis и управления кэшированием данных.",
            "Что такое виртуальная реальность?": "Виртуальная реальность (VR) - это технология, создающая иммерсивную цифровую среду, позволяющая пользователю взаимодействовать с виртуальным миром через специальные устройства, такие как очки VR.",
            "Как работает алгоритм шифрования AES?": "AES (Advanced Encryption Standard) - это симметричный алгоритм шифрования, который использует ключи длиной 128, 192 или 256 бит для защиты данных.",
            "Что такое искусственный интеллект?": "Искусственный интеллект (AI) - это область компьютерной науки, занимающаяся созданием систем, способных выполнять задачи, требующие человеческого интеллекта, такие как распознавание речи, принятие решений и анализ данных.",
            "Как работает алгоритм сжатия данных Huffman?": "Алгоритм Хаффмана сжимает данные, создавая дерево кодов, где часто встречающиеся символы имеют более короткие коды, а редкие символы - более длинные.",
            "Что такое облачные вычисления?": "Облачные вычисления предоставляют доступ к вычислительным ресурсам и сервисам через интернет, позволяя пользователям хранить и обрабатывать данные на удалённых серверах.",
            "Как работает технология NFC?": "NFC (Near Field Communication) - это технология беспроводной передачи данных на короткие расстояния, используемая для бесконтактных платежей и обмена информацией между устройствами.",
            "Что такое робототехника?": "Робототехника - это область инженерии, занимающаяся разработкой, конструированием и эксплуатацией роботов, которые могут выполнять различные задачи автоматически или с помощью человека.",
            "Как работает технология 5G?": "5G - это пятое поколение мобильных сетей, обеспечивающее высокую скорость передачи данных, низкую задержку и поддержку большого количества подключённых устройств.",
            "Что такое интернет вещей?": "Интернет вещей (IoT) - это сеть физических устройств, оснащённых датчиками, программным обеспечением и другими технологиями, которые позволяют им собирать и обмениваться данными через интернет.",
            "Как работает алгоритм шифрования Blowfish?": "Blowfish - это симметричный блочный алгоритм шифрования, использующий переменный размер ключа (от 32 до 448 бит) для шифрования данных блоками по 64 бита.",
            "Что такое квантовые вычисления?": "Квантовые вычисления используют принципы квантовой механики для выполнения вычислений, что позволяет решать определённые задачи значительно быстрее, чем классические компьютеры.",
            "Как работает интернет вещей (IoT)?": "Интернет вещей (IoT) объединяет различные устройства, которые собирают и обмениваются данными через сеть, обеспечивая автоматизацию и удалённое управление.",
            "Что такое блокчейн?": "Блокчейн - это распределённая база данных, в которой информация хранится в виде цепочки блоков, связанных друг с другом с использованием криптографических методов.",
            "Как работает алгоритм K-средних?": "Алгоритм K-средних (K-means) разделяет данные на K кластеров, минимизируя сумму квадратов расстояний между точками и центроидами кластеров.",
            "Что такое машинное обучение?": "Машинное обучение - это область искусственного интеллекта, которая занимается созданием алгоритмов и моделей, способных обучаться на данных и делать прогнозы или принимать решения без явного программирования.",
            "Как работает технология 3D-печати?": "3D-печать - это процесс создания трёхмерных объектов путём послойного добавления материала на основе цифровой модели.",
            "Что такое машинное зрение?": "Машинное зрение - это технология, которая позволяет компьютерам получать, обрабатывать и анализировать визуальную информацию из внешнего мира для управления процессами или принятия решений.",
            "Как работает алгоритм Dijkstra?": "Алгоритм Дейкстры находит кратчайший путь от одной вершины графа до всех остальных, используя жадный подход для постепенного увеличения множества достигнутых вершин.",
            "Что такое естественный язык?": "Естественный язык - это язык, который используется людьми для общения, в отличие от формальных или программных языков.",
            "Как работает алгоритм сжатия данных LZ77?": "Алгоритм LZ77 сжимает данные, заменяя повторяющиеся последовательности символов ссылками на предыдущие вхождения этих последовательностей в окне фиксированного размера.",
            "Что такое глубокое обучение?": "Глубокое обучение - это подмножество машинного обучения, которое использует многослойные нейронные сети для моделирования сложных паттернов в данных.",
            "Как работает алгоритм сортировки пузырьком?": "Алгоритм сортировки пузырьком сравнивает соседние элементы массива и меняет их местами, если они находятся в неправильном порядке, повторяя этот процесс до тех пор, пока массив не будет отсортирован.",
            "Что такое протокол TCP/IP?": "TCP/IP - это набор сетевых протоколов, которые обеспечивают передачу данных в сети Интернет.",
            "Как создать виртуальное окружение в Python?": "Используйте команду 'python -m venv имя_окружения' для создания виртуального окружения в Python.",
            "Что такое Big Data?": "Big Data - это большие объёмы данных, которые сложно обрабатывать с помощью традиционных методов и инструментов.",
            "Как работает алгоритм сжатия данных?": "Алгоритм сжатия данных уменьшает размер данных путём удаления редундантной информации и использования специальных кодировок.",
            "Что такое биометрия?": "Биометрия - это технология распознавания и идентификации людей на основе их физических или поведенческих характеристик, таких как отпечатки пальцев, лица или голоса.",
            "Как работает алгоритм PageRank?": "PageRank - это алгоритм ранжирования веб-страниц, разработанный Google, который оценивает важность страницы на основе количества и качества ссылок на неё.",
            "Что такое виртуальная реальность?": "Виртуальная реальность (VR) - это технология, создающая иммерсивную цифровую среду, позволяющая пользователю взаимодействовать с виртуальным миром через специальные устройства, такие как очки VR.",
            "Как работает алгоритм шифрования AES?": "AES (Advanced Encryption Standard) - это симметричный алгоритм шифрования, который использует ключи длиной 128, 192 или 256 бит для защиты данных.",
            "Что такое искусственный интеллект?": "Искусственный интеллект (AI) - это область компьютерной науки, занимающаяся созданием систем, способных выполнять задачи, требующие человеческого интеллекта, такие как распознавание речи, принятие решений и анализ данных.",
            "Как работает алгоритм сжатия данных Huffman?": "Алгоритм Хаффмана сжимает данные, создавая дерево кодов, где часто встречающиеся символы имеют более короткие коды, а редкие символы - более длинные.",
            "Что такое облачные вычисления?": "Облачные вычисления предоставляют доступ к вычислительным ресурсам и сервисам через интернет, позволяя пользователям хранить и обрабатывать данные на удалённых серверах.",
            "Как работает технология NFC?": "NFC (Near Field Communication) - это технология беспроводной передачи данных на короткие расстояния, используемая для бесконтактных платежей и обмена информацией между устройствами.",
            "Что такое робототехника?": "Робототехника - это область инженерии, занимающаяся разработкой, конструированием и эксплуатацией роботов, которые могут выполнять различные задачи автоматически или с помощью человека.",
            "Как работает технология 5G?": "5G - это пятое поколение мобильных сетей, обеспечивающее высокую скорость передачи данных, низкую задержку и поддержку большого количества подключённых устройств.",
            "Что такое фотосинтез?": "Фотосинтез - это процесс, с помощью которого растения, водоросли и некоторые бактерии преобразуют солнечный свет, углекислый газ и воду в глюкозу и кислород.",
            "Как работает закон всемирного тяготения?": "Закон всемирного тяготения, сформулированный Исааком Ньютоном, гласит, что каждая частица во Вселенной притягивает каждую другую частицу с силой, прямо пропорциональной произведению их масс и обратно пропорциональной квадрату расстояния между ними.",
            "Что такое ДНК?": "ДНК (дезоксирибонуклеиновая кислота) - это молекула, содержащая генетическую информацию, необходимую для развития и функционирования всех живых организмов.",
            "Как решать квадратные уравнения?": "Квадратные уравнения вида ax^2 + bx + c = 0 можно решать с помощью формулы корней: x = (-b ± √(b^2 - 4ac)) / 2a.",
            "Что такое Великая Китайская стена?": "Великая Китайская стена - это серия укреплений, построенных в Китае для защиты от набегов и вторжений кочевых народов и других военных угроз.",
            "Как функционирует иммунная система человека?": "Иммунная система человека защищает организм от инфекций и болезней, используя белые кровяные клетки, антитела и другие механизмы для обнаружения и уничтожения патогенов.",
            "Что такое теория относительности?": "Теория относительности, разработанная Альбертом Эйнштейном, включает специальную и общую теории относительности, которые описывают поведение объектов в пространстве-времени и влияние гравитации.",
            "Как вычислить площадь круга?": "Площадь круга можно вычислить по формуле A = πr^2, где r - радиус круга.",
            "Что такое химическая реакция?": "Химическая реакция - это процесс, при котором вещества (реагенты) преобразуются в новые вещества (продукты) с изменением химических связей.",
            "Каковы основные причины глобального потепления?": "Основные причины глобального потепления включают выбросы парниковых газов, таких как углекислый газ и метан, в результате сжигания ископаемого топлива, вырубки лесов и промышленной деятельности.",
            "Что такое Пифагоровы штаны?": "Пифагоровы штаны - это народное название теоремы Пифагора, которая утверждает, что квадрат гипотенузы прямоугольного треугольника равен сумме квадратов его катетов.",
            "Как работает сердце человека?": "Сердце человека - это мышечный орган, который перекачивает кровь через сеть артерий и вен, обеспечивая доставку кислорода и питательных веществ к клеткам организма.",
            "Что такое гравитационные волны?": "Гравитационные волны - это рябь в пространстве-времени, вызванная ускоренным движением массивных объектов, таких как слияние черных дыр или нейтронных звезд.",
            "Как определить кислотность раствора?": "Кислотность раствора определяется уровнем pH, который измеряет концентрацию ионов водорода; pH ниже 7 указывает на кислоту, pH 7 - на нейтральную среу, pH выше 7 - на щелочь.",
            "Что такое Большой каньон?": "Большой каньон - это глубокая долина, вырезанная рекой Колорадо в северной Аризоне, США, известная своими величественными видами и геологической значимостью.",
            "Как работает закон сохранения энергии?": "Закон сохранения энергии утверждает, что энергия не может быть создана или уничтожена; она может лишь переходить из одной формы в другую.",
            "Что такое термодинамика?": "Термодинамика - это раздел физики, изучающий отношения между теплом, работой, температурой и энергией.",
            "Каковы функции печени в организме человека?": "Печень выполняет множество функций, включая детоксикацию крови, производство желчи для пищеварения, хранение гликогена и метаболизм лекарств и других веществ.",
            "Что изучает астрономия?": "Астрономия - это наука, изучающая небесные объекты, такие как звезды, планеты, кометы, галактики, а также процессы и явления за пределами Земли.",
            "Как решать системы линейных уравнений?": "Системы линейных уравнений можно решать методами подстановки, исключения или с использованием матричных методов, таких как метод Гаусса.",
            "Как работает магнитное поле Земли?": "Магнитное поле Земли создается движением жидкого железа в её внешнем ядре и защищает планету от космических лучей и солнечного ветра.",
            "Что такое инерция?": "Инерция - это свойство тела сохранять состояние покоя или равномерного прямолинейного движения, если на него не действуют внешние силы.",
            "Как работает пищеварительная система человека?": "Пищеварительная система человека включает органы, такие как рот, желудок и кишечник, которые вместе переваривают пищу, абсорбируют питательные вещества и выводят отходы.",
            "Что такое теория Большого взрыва?": "Теория Большого взрыва предполагает, что Вселенная начала расширяться из чрезвычайно горячего и плотного состояния примерно 13,8 миллиардов лет назад.",
            "Как работает электромагнитная индукция?": "Электромагнитная индукция - это процесс, при котором изменение магнитного поля вызывает электрический ток в проводнике.",
            "Что такое теплопроводность?": "Теплопроводность - это способность материала проводить тепло от одной части к другой.",
            "Как функционирует дыхательная система человека?": "Дыхательная система человека включает легкие и дыхательные пути, которые обеспечивают поступление кислорода в кровь и вывод углекислого газа из организма.",
            "Что такое периодическая таблица Менделеева?": "Периодическая таблица Менделеева - это табличное отображение химических элементов, упорядоченных по их атомному номеру, электронной конфигурации и повторяющимся химическим свойствам.",
            "Как работает закон Архимеда?": "Закон Архимеда гласит, что на тело, погруженное в жидкость, действует выталкивающая сила, равная весу вытесненной этим телом жидкости.",
            "Что такое ренессанс?": "Ренессанс - это культурное движение и исторический период, начавшийся в Италии в XIV веке и распространившийся по Европе, характеризующийся возрождением интереса к античному искусству, литературе и наукам.",
            "Как работает нервная система человека?": "Нервная система человека контролирует и координирует деятельность организма через сеть нервов и клеток, передающих электрические и химические сигналы.",
            "Что такое симфония?": "Симфония - это крупное музыкальное произведение для оркестра, обычно состоящее из нескольких частей или движений.",
            "Каковы основные функции почек?": "Основные функции почек включают фильтрацию крови для удаления отходов и избытка веществ, регулирование водно-солевого баланса и поддержание кислотно-щелочного равновесия.",
            "Что такое экосистема?": "Экосистема - это сообщество живых организмов и их физическая среда, взаимодействующие как единое целое.",
            "Как работает закон Паскаля?": "Закон Паскаля утверждает, что давление, приложенное к жидкости в замкнутом сосуде, передается без изменения на все точки жидкости.",
            "Что такое демократическая республика?": "Демократическая республика - это форма правления, в которой власть принадлежит народу и осуществляется через избранных представителей.",
            "Каковы основные принципы гигиены?": "Основные принципы гигиены включают регулярное мытье рук, поддержание чистоты тела и окружающей среды, а также правильное питание и отдых.",
            "Что такое электролиз?": "Электролиз - это процесс разложения вещества на составляющие элементы с помощью электрического тока.",
            "Как работает глаз человека?": "Глаз человека воспринимает свет и преобразует его в электрические сигналы, которые передаются в мозг для создания визуальных изображений.",
            "Что такое генная инженерия?": "Генная инженерия - это технология, позволяющая изменять генетический материал организма для получения желаемых свойств или функций.",
            "Что такое интеграция?": "Интеграция - это процесс нахождения интеграла функции, который является обратным процессом дифференцирования.",
            "Как работает закон Ома?": "Закон Ома гласит, что ток, проходящий через проводник, прямо пропорционален напряжению и обратно пропорционален сопротивлению проводника.",
            "Что такое ренессансная архитектура?": "Ренессансная архитектура - это стиль архитектуры, развившийся в Италии в период ренессанса, характеризующийся симметрией, пропорциями и использованием античных мотивов.",
            "Каковы симптомы гриппа?": "Симптомы гриппа включают высокую температуру, головную боль, усталость, кашель, боль в горле и мышечные боли.",
            "Что такое атомная структура?": "Атомная структура состоит из ядра, содержащего протоны и нейтроны, окруженного электронами, которые движутся по орбитам вокруг ядра.",
            "Как решать задачи на движение?": "Задачи на движение решаются с использованием формул скорости, времени и расстояния: скорость = расстояние / время.",
            "Что такое культурная антропология?": "Культурная антропология - это наука, изучающая культуру и общественные структуры различных народов.",
            "Как работает паровая турбина?": "Паровая турбина преобразует тепловую энергию пара в механическую работу, вращая вал, который может использоваться для генерации электроэнергии.",
            "Что такое симметрия в математике?": "Симметрия в математике - это свойство фигуры или объекта, при котором он остается неизменным при определенных преобразованиях, таких как отражение, вращение или сдвиг.",
            "Каковы причины и последствия изменения климата?": "Причины изменения климата включают выбросы парниковых газов, вырубку лесов и промышленную деятельность. Последствия включают повышение температуры, изменение погодных условий и повышение уровня моря.",
            "Что такое классическая музыка?": "Классическая музыка - это жанр музыки, который включает произведения, написанные в традициях западной музыкальной культуры, таких как симфонии, сонаты и оперы.",
            "Как работает фотонная терапия?": "Фотонная терапия использует световые волны для лечения различных медицинских состояний, стимулируя клеточные процессы и улучшая заживление тканей.",
            "Что такое генная терапия?": "Генная терапия - это метод лечения заболеваний путем введения генетического материала в клетки пациента для исправления дефектных генов или для борьбы с болезнью.",
            "Каковы основные стили изобразительного искусства?": "Основные стили изобразительного искусства включают реализм, импрессионизм, экспрессионизм, кубизм, сюрреализм и абстракционизм.",
            "Что такое теория эволюции?": "Теория эволюции, предложенная Чарльзом Дарвином, объясняет процесс изменения видов со временем через естественный отбор.",
            "Как работает система кровообращения?": "Система кровообращения перекачивает кровь по всему телу, доставляя кислород и питательные вещества к клеткам и удаляя продукты обмена веществ.",
            "Что такое механика?": "Механика - это раздел физики, изучающий движение и взаимодействие тел под действием сил.",
            "Как работает электромагнитное излучение?": "Электромагнитное излучение - это поток фотонов, движущихся с постоянной скоростью света и несущих энергию в виде волн.",
            "Что такое демократическое общество?": "Демократическое общество - это общество, в котором власть принадлежит народу, и решения принимаются через представительские институты или прямое голосование.",
            "Каковы методы профилактики заболеваний?": "Методы профилактики заболеваний включают вакцинацию, здоровое питание, регулярные физические упражнения, соблюдение гигиены и периодические медицинские осмотры.",
            "Что такое теория струн?": "Теория струн - это физическая теория, предполагающая, что фундаментальные частицы являются одномерными объектами (струнами), вибрации которых определяют их свойства.",
            "Как работает солнечная энергия?": "Солнечная энергия преобразуется в электричество с помощью солнечных панелей, которые используют фотоэлементы для улавливания и преобразования солнечного света.",
            "Что такое экономическая система?": "Экономическая система - это способ организации производства, распределения и потребления товаров и услуг в обществе.",
            "Каковы причины и последствия загрязнения воздуха?": "Причины загрязнения воздуха включают выбросы от транспорта, промышленных предприятий и сжигания фоссильных топлив. Последствия включают ухудшение здоровья, климатические изменения и повреждение экосистем.",
            "Что такое генная мутация?": "Генетическая мутация - это изменение в последовательности ДНК, которое может привести к изменению функции гена и, как следствие, к различным заболеваниям или новым признакам.",
            "Как работает гидроэлектростанция?": "Гидроэлектростанция использует энергию падающей воды для вращения турбин, которые затем приводят в действие генераторы, производящие электричество.",
            "Что такое культурное наследие?": "Культурное наследие включает материальные и нематериальные объекты, такие как памятники, произведения искусства, традиции и знания, передаваемые от поколения к поколению.",
            "Каковы основные понятия квантовой физики?": "Основные понятия квантовой физики включают квантование энергии, принцип неопределенности Гейзенберга, волновую функцию и суперпозицию состояний.",
            "Что такое иммунитет?": "Иммунитет - это способность организма защищаться от инфекционных агентов, таких как бактерии и вирусы, с помощью иммунной системы.",
            "Как функционирует денежная система?": "Денежная система включает создание, распространение и управление деньгами в экономике, а также обеспечение стабильности валюты и регулирование финансовых институтов.",
            "Что такое архитектура эпохи барокко?": "Архитектура эпохи барокко характеризуется пышностью, драматическими эффектами, изобилием декора и сложными формами, стремящимися к величию и эмоциональному воздействию.",
            "Каковы методы лечения диабета?": "Методы лечения диабета включают управление уровнем сахара в крови с помощью диеты, физических упражнений, медикаментов и инсулинотерапии.",
            "Что такое теория хаоса?": "Теория хаоса изучает динамические системы, чувствительные к начальным условиям, где небольшие изменения могут приводить к непредсказуемым и сложным поведениям.",
            "Как работает система образования в разных странах?": "Системы образования различаются по структуре, методам обучения и оценивания, а также по уровню доступности и финансирования в разных странах.",
            "Что такое биосфера?": "Биосфера - это совокупность всех экосистем Земли, включающая живые организмы и их взаимодействие с окружающей средой.",
            "Каковы причины и последствия обезлесения?": "Причины обезлесения включают вырубку лесов для сельского хозяйства, урбанизацию и промышленное использование. Последствия включают утрату биоразнообразия, изменение климата и деградацию почв.",
            "Что такое логарифм?": "Логарифм - это математическая функция, обратная возведению в степень, определяющая степень, в которую нужно возвести основание, чтобы получить заданное число.",
            "Как функционирует транспортная система?": "Транспортная система включает в себя инфраструктуру, такие как дороги и железные дороги, а также средства передвижения и организацию перевозок для обеспечения перемещения людей и грузов.",
            "Что такое искусственный интеллект?": "Искусственный интеллект (AI) - это область компьютерной науки, занимающаяся созданием систем, способных выполнять задачи, требующие человеческого интеллекта, такие как распознавание речи, принятие решений и анализ данных.",
            "Каковы основные типы экономических ресурсов?": "Основные типы экономических ресурсов включают природные ресурсы, человеческие ресурсы (труд), капитальные ресурсы (оборудование и здания) и предпринимательские способности.",
            "Что такое экологический след?": "Экологический след - это мера воздействия человека на окружающую среду, выраженная в количестве используемых природных ресурсов и произведенных отходов.",
            "Как работает ядерный реактор?": "Ядерный реактор использует цепную реакцию деления ядер для производства тепла, которое затем используется для генерации электричества.",
            "Что такое философия?": "Философия - это дисциплина, изучающая фундаментальные вопросы бытия, знания, морали, разума и языка.",
            "Каковы основные функции кожи человека?": "Основные функции кожи включают защиту организма от внешних воздействий, регуляцию температуры и восприятие ощущений.",
            "Что такое налоговая система?": "Налоговая система - это совокупность правил и учреждений, регулирующих сбор налогов и их распределение для финансирования государственных расходов.",
            "Как работают электрические цепи?": "Электрические цепи состоят из компонентов, таких как резисторы, конденсаторы и индуктивности, соединенных проводами, по которым течет электрический ток.",
            "Что такое ландшафтная архитектура?": "Ландшафтная архитектура - это планирование, проектирование и управление открытыми пространствами и природными территориями для создания функциональных и эстетически привлекательных ландшафтов.",
            "Каковы основные принципы йоги?": "Основные принципы йоги включают физические упражнения (асаны), дыхательные техники (пранаяма), медитацию и этические нормы.",
            "Что такое анатомия?": "Анатомия - это наука, изучающая структуру и форму организмов и их частей.",
            "Как функционирует банковская система?": "Банковская система включает коммерческие банки, центральные банки и другие финансовые учреждения, которые управляют денежными средствами, предоставляют кредиты и обеспечивают платежи.",
            "Что такое оптика?": "Оптика - это раздел физики, изучающий свойства и поведение света, а также его взаимодействие с веществом.",
            "Каковы причины и последствия миграции?": "Причины миграции включают экономические возможности, политические конфликты и климатические изменения. Последствия могут включать культурное обогащение, напряженность на рынке труда и изменения в демографии.",
            "Что такое астрофизика?": "Астрофизика - это раздел астрономии, изучающий физические свойства и процессы небесных объектов и явлений.",
            "Как работает система здравоохранения?": "Система здравоохранения включает учреждения и специалистов, предоставляющих медицинские услуги, профилактику заболеваний и лечение пациентов.",
            "Что такое нанотехнологии?": "Нанотехнологии - это область науки и техники, занимающаяся созданием и применением материалов и устройств на нанометровом уровне.",
            "Каковы основные понятия статистики?": "Основные понятия статистики включают выборку, среднее значение, медиану, моду, стандартное отклонение и корреляцию.",
            "Что такое культурное разнообразие?": "Культурное разнообразие - это существование множества различных культур и традиций в рамках одного общества или мира в целом.",
            "Как работает радиоволна?": "Радиоволна - это электромагнитная волна, используемая для передачи информации через пространство с помощью радиопередатчиков и радиоприемников.",
            "Что такое биодоступность?": "Биодоступность - это степень и скорость, с которой активное вещество (например, лекарство) абсорбируется в кровь и становится доступным для воздействия на организм.",
            "Каковы причины и последствия урбанизации?": "Причины урбанизации включают поиск работы, улучшение условий жизни и доступ к услугам. Последствия могут включать рост городов, загрязнение окружающей среды и изменения в социальной структуре.",
            "Что такое биомасса?": "Биомасса - это органическое вещество, используемое в качестве источника энергии, получаемое из растений и животных остатков.",
            "Как работает фотосинтез?": "Фотосинтез - это процесс, при котором растения используют солнечный свет, воду и углекислый газ для производства глюкозы и кислорода.",
            "Что такое кинетическая энергия?": "Кинетическая энергия - это энергия, которую имеет объект благодаря своему движению.",
            "Как функционирует почтовая система?": "Почтовая система включает в себя сбор, сортировку, транспортировку и доставку писем и посылок.",
            "Что такое археология?": "Археология - это наука, изучающая прошлое человечества через раскопки и анализ материальных остатков.",
            "Как работает гидравлический пресс?": "Гидравлический пресс использует жидкость под давлением для создания силы, которая сжимает или деформирует материалы.",
            "Что такое гравитация?": "Гравитация - это сила притяжения, действующая между всеми массами во Вселенной.",
            "Каковы основные причины инфляции?": "Основные причины инфляции включают увеличение спроса, рост затрат на производство и увеличение денежной массы.",
            "Что такое социология?": "Социология - это наука, изучающая общество, социальные отношения и институты.",
            "Как работает тепловой двигатель?": "Тепловой двигатель преобразует тепловую энергию в механическую работу через процессы нагрева и охлаждения рабочего тела.",
            "Как работает алгоритм Дейкстры?": "Алгоритм Дейкстры находит кратчайший путь от одной вершины графа до всех остальных, используя приоритетную очередь для выбора вершины с минимальной стоимостью.",
            "Что такое хэш-таблица?": "Хэш-таблица - это структура данных, которая использует хэш-функцию для сопоставления ключей с соответствующими значениями, обеспечивая быструю вставку, удаление и поиск.",
            "Как работает алгоритм Краскала?": "Алгоритм Краскала находит минимальное остовное дерево в графе, сортируя все ребра по весу и добавляя их в дерево, избегая циклов, пока все вершины не будут соединены."
        };

        // Инициализация Telegram WebApp
        const tg = window.Telegram?.WebApp;
        if (tg) {
            tg.expand();
            tg.ready();
        }

        // Функция поиска похожих вопросов
        function findSimilarQuestions(input) {
            const userInput = input.trim().toLowerCase().replace(/[.,?!]/g, '');
            const normalizedInput = userInput.replace(/\s+/g, ' ');
            const inputWords = normalizedInput.split(' ');

            const results = Object.keys(database).map(question => {
                const normalizedQuestion = question.toLowerCase().replace(/[.,?!]/g, '').replace(/\s+/g, ' ');
                const questionWords = normalizedQuestion.split(' ');

                let matchScore = 0;
                inputWords.forEach(word => {
                    if (word.length > 2 && questionWords.some(qWord => qWord.includes(word) || word.includes(qWord))) {
                        matchScore++;
                    }
                });

                return {
                    question,
                    score: matchScore / Math.max(inputWords.length, questionWords.length)
                };
            });

            return results
                .filter(result => result.score > 0.3)
                .sort((a, b) => b.score - a.score)
                .map(result => result.question);
        }

        // Оптимизированное создание снежинок
        let snowflakeCount = 0;
        const MAX_SNOWFLAKES = 15;

        function createSnowflakes() {
            if (snowflakeCount >= MAX_SNOWFLAKES) {
                return;
            }

            const snowflake = document.createElement('div');
            snowflake.classList.add('snowflake');
            snowflake.style.left = Math.random() * 100 + 'vw';
            snowflake.style.animationDuration = Math.random() * 5 + 3 + 's';
            snowflake.style.opacity = Math.random() * 0.2 + 0.1;
            document.body.appendChild(snowflake);

            snowflake.style.top = -10 + 'px';
            snowflakeCount++;

            snowflake.addEventListener('animationend', () => {
                snowflake.remove();
                snowflakeCount--;
            });
        }

        setInterval(createSnowflakes, 800);

        // Функции чата
        const chatContainer = document.getElementById('chatContainer');
        const messagesWrapper = document.getElementById('messagesWrapper');
        const questionInput = document.getElementById('questionInput');
        const sendButton = document.getElementById('sendButton');

        function createMessageElement(text, isUser) {
            const messageDiv = document.createElement('div');
            messageDiv.classList.add('message');
            messageDiv.classList.add(isUser ? 'user-message' : 'bot-message');

            if (!isUser) {
                const iconDiv = document.createElement('div');
                iconDiv.classList.add('message-icon');
                iconDiv.innerHTML = `
                    <svg viewBox="0 0 24 24">
                        <path d="M12,2A2,2 0 0,1 14,4C14,4.74 13.6,5.39 13,5.73V7H14A7,7 0 0,1 21,14H22A1,1 0 0,1 23,15V18A1,1 0 0,1 22,19H21V20A2,2 0 0,1 19,22H5A2,2 0 0,1 3,20V19H2A1,1 0 0,1 1,18V15A1,1 0 0,1 2,14H3A7,7 0 0,1 10,7H11V5.73C10.4,5.39 10,4.74 10,4A2,2 0 0,1 12,2M7.5,13A2.5,2.5 0 0,0 5,15.5A2.5,2.5 0 0,0 7.5,18A2.5,2.5 0 0,0 10,15.5A2.5,2.5 0 0,0 7.5,13M16.5,13A2.5,2.5 0 0,0 14,15.5A2.5,2.5 0 0,0 16.5,18A2.5,2.5 0 0,0 19,15.5A2.5,2.5 0 0,0 16.5,13Z" />
                    </svg>`;
                messageDiv.appendChild(iconDiv);
            }

            const textSpan = document.createElement('span');
            textSpan.textContent = text;
            messageDiv.appendChild(textSpan);
            return messageDiv;
        }

        async function typeResponse(text) {
            const words = text.split(' ');
            const messageElement = createMessageElement('', false);
            const textSpan = messageElement.querySelector('span');
            messagesWrapper.appendChild(messageElement);

            for (const word of words) {
                await new Promise(resolve => {
                    requestAnimationFrame(() => {
                        textSpan.textContent += word + ' ';
                        chatContainer.scrollTop = chatContainer.scrollHeight;
                        setTimeout(resolve, 50);
                    });
                });
            }
        }

        async function handleQuestion() {
            const question = questionInput.value.trim();
            if (!question) return;

            const messageElement = createMessageElement(question, true);
            messagesWrapper.appendChild(messageElement);
            questionInput.value = '';
            chatContainer.scrollTop = chatContainer.scrollHeight;

            try {
                // Поиск точного совпадения
                const normalizedQuestion = question.toLowerCase().replace(/\s+/g, ' ');
                let answer = database[normalizedQuestion];

                // Если точного совпадения нет, ищем похожие вопросы
                if (!answer) {
                    const similarQuestions = findSimilarQuestions(question);
                    if (similarQuestions.length > 0) {
                        // Если найден вопрос с высоким сходством, сразу даём ответ
                        const bestMatch = similarQuestions[0];
                        const bestMatchNormalized = bestMatch.toLowerCase().replace(/[.,?!]/g, '').replace(/\s+/g, ' ');
                        const questionNormalized = question.toLowerCase().replace(/[.,?!]/g, '').replace(/\s+/g, ' ');

                        if (bestMatchNormalized.includes(questionNormalized) || 
                            questionNormalized.includes(bestMatchNormalized) ||
                            (questionNormalized.length > 3 && bestMatchNormalized.includes(questionNormalized.substring(0, questionNormalized.length - 1)))) {
                            answer = database[bestMatch];
                        } else {
                            let currentSuggestions = similarQuestions.slice(0, 3);
                            window.lastSuggestions = currentSuggestions;
                            answer = "Возможно, вы имели в виду:\n\n" + 
                                    currentSuggestions.map(q => "• " + q).join("\n") +
                                    "\n\nОтветьте 'да', если какой-то из этих вопросов вам подходит, или 'нет' для других вариантов.";
                        }
                    } else {
                        answer = "Извините, я не нашёл похожих вопросов в моей базе данных. Попробуйте переформулировать вопрос или задать другой.";
                    }
                }

                // Обработка ответов да/нет
                if (normalizedQuestion === 'да' && window.lastSuggestions?.length > 0) {
                    answer = database[window.lastSuggestions[0]];
                    window.lastSuggestions = null;
                } else if (normalizedQuestion === 'нет' && window.lastSuggestions?.length > 0) {
                    const remainingSuggestions = findSimilarQuestions(question)
                        .filter(q => !window.lastSuggestions.includes(q))
                        .slice(0, 3);

                    if (remainingSuggestions.length > 0) {
                        window.lastSuggestions = remainingSuggestions;
                        answer = "Вот другие варианты:\n\n" +
                                remainingSuggestions.map(q => "• " + q).join("\n") +
                                "\n\nОтветьте 'да', если какой-то из этих вопросов вам подходит, или 'нет' для других вариантов.";
                    } else {
                        window.lastSuggestions = null;
                        answer = "Больше нет похожих вопросов. Попробуйте переформулировать ваш вопрос.";
                    }
                }

                await typeResponse(answer);
            } catch (error) {
                console.error('Error handling question:', error);
                await typeResponse("Извините, произошла ошибка при обработке вашего вопроса. Попробуйте еще раз.");
            }
        }

        questionInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                handleQuestion();
            }
        });

        sendButton.addEventListener('click', handleQuestion);

        // Приветственное сообщение
        setTimeout(() => {
            typeResponse("Привет! Задайте мне вопрос, и я постараюсь на него ответить.");
        }, 500);
    </script>
</body>
</html>
