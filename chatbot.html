<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ChatBot</title>
    <style>
        /* Стиль для иконки */
        #chatbot-icon {
            position: fixed;
            bottom: 10px;
            right: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        /* Стиль для иконки на мобильных устройствах */
        @media (max-width: 768px) {
            #chatbot-icon {
                width: 50px;
                height: 50px;
            }
        }

        /* Стиль для иконки на десктопах */
        @media (min-width: 769px) {
            #chatbot-icon {
                width: 80px;
                height: 80px;
            }
        }

        /* Стиль для модального окна чата */
        #chat-window {
            display: none;
            position: fixed;
            bottom: 10px;
            right: 10px;
            width: 350px;
            height: 450px;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0px 0px 10px rgba(0,0,0,0.1);
            z-index: 1000;
            padding: 20px;
        }

        /* Стиль для области сообщений */
        #messages {
            height: 80%;
            overflow-y: auto;
            margin-bottom: 20px;
        }

        /* Стиль для поля ввода сообщений */
        #input-message {
            width: 100%;
            padding: 10px;
            border-radius: 5px;
            border: 1px solid #ddd;
        }

    </style>
</head>
<body>

<!-- Иконка ChatBot -->
<img id="chatbot-icon" src="chatbot-icon.png" alt="ChatBot" onclick="toggleChat()">

<!-- Модальное окно чата -->
<div id="chat-window">
    <div id="messages"></div>
    <input type="text" id="input-message" placeholder="Напишите сообщение..." onkeydown="sendMessage(event)">
</div>

<script>
// Инициализация переменных
let chatWindow = document.getElementById('chat-window');
let messages = document.getElementById('messages');
let inputMessage = document.getElementById('input-message');

// API-ключ от OpenAI
const apiKey = "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";

// Функция для отображения и скрытия чата
function toggleChat() {
    chatWindow.style.display = chatWindow.style.display === 'none' ? 'block' : 'none';
}

// Функция для отправки сообщений
function sendMessage(event) {
    if (event.key === 'Enter') {
        let userMessage = inputMessage.value.trim();
        if (userMessage) {
            appendMessage("Вы: " + userMessage);
            inputMessage.value = '';
            getChatbotResponse(userMessage);
        }
    }
}

// Функция для получения ответа от ChatGPT
function getChatbotResponse(userMessage) {
    fetch('https://api.openai.com/v1/completions', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            'Authorization': Bearer ${apiKey}
        },
        body: JSON.stringify({
            model: 'gpt-3.5-turbo',
            messages: [{ role: 'user', content: userMessage }],
            max_tokens: 150
        })
    })
    .then(response => response.json())
    .then(data => {
        let botMessage = data.choices[0].message.content.trim();
        appendMessage("ChatBot: " + botMessage);
    })
    .catch(error => {
        console.error('Ошибка:', error);
    });
}

// Функция для добавления сообщений в окно чата
function appendMessage(message) {
    let messageElement = document.createElement('div');
    messageElement.textContent = message;
    messages.appendChild(messageElement);
    messages.scrollTop = messages.scrollHeight;
}

// Инициализация иконки и окна чата
window.onload = () => {
    chatWindow.style.display = 'none';
};
</script>

</body>
</html>
